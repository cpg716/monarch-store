# Maintainer: MonARCH Team <monarch@example.com>
pkgname=monarch-store
pkgver=0.2.29
pkgrel=1
pkgdesc="A high-performance, premium software store for Arch Linux (Tauri based)"
arch=('x86_64' 'aarch64')
url="https://github.com/monarch-store/monarch-store"
license=('MIT')
depends=('webkit2gtk' 'gtk3' 'libappindicator-gtk3' 'curl' 'wget' 'polkit')
makedepends=('npm' 'cargo' 'git')
source=("${pkgname}-${pkgver}.tar.gz::${url}/archive/v${pkgver}.tar.gz")
sha256sums=('eade1a0a50b32b6d224f61f35b2728a3f6266782f7f290a2d65294ec7f844bca')

build() {
	cd "$pkgname"
	npm install
	npm run tauri build
}

package() {
	cd "$pkgname"
	
	# Install the binary
	install -Dm755 "src-tauri/target/release/monarch-store" "$pkgdir/usr/bin/$pkgname"
	
	# Install the icon
	install -Dm644 "src-tauri/icons/128x128.png" "$pkgdir/usr/share/icons/hicolor/128x128/apps/$pkgname.png"
	
	# Install the desktop file
	# (Assuming one is generated or we create one here)
	mkdir -p "$pkgdir/usr/share/applications"
	cat > "$pkgdir/usr/share/applications/$pkgname.desktop" <<EOF
[Desktop Entry]
Type=Application
Name=MonARCH Store
Comment=High-performance software store for Arch Linux
Exec=$pkgname
Icon=$pkgname
Categories=System;
EOF
}
